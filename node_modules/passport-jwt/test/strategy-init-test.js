var Strategy = require('../lib/strategy');

describe('Strategy', function() ***REMOVED***
    var strategy = new Strategy(***REMOVED***jwtFromRequest: function()***REMOVED******REMOVED***, secretOrKey: 'secret'***REMOVED***, function() ***REMOVED******REMOVED***);

    it('should be named jwt', function() ***REMOVED***
        expect(strategy.name).to.equal('jwt');
    ***REMOVED***);


    it('should throw if constructed without a verify callback', function() ***REMOVED***
        expect(function() ***REMOVED***
            var s = new Strategy(***REMOVED***jwtFromRequest: function(r) ***REMOVED******REMOVED***, secretOrKey: 'secret'***REMOVED***);
        ***REMOVED***).to.throw(TypeError, "JwtStrategy requires a verify callback");
    ***REMOVED***);


    it('should throw if constructed without a secretOrKey arg', function() ***REMOVED***
        expect(function() ***REMOVED***
            var s = new Strategy(***REMOVED***jwtFromRequest: function(r) ***REMOVED******REMOVED***, secretOrKey: null***REMOVED***, function() ***REMOVED******REMOVED***);
        ***REMOVED***).to.throw(TypeError, 'JwtStrategy requires a secret or key');
    ***REMOVED***);


    it('should throw if constructed without a jwtFromRequest arg', function() ***REMOVED***
        expect(function() ***REMOVED***
            var s = new Strategy(***REMOVED***secretOrKey: 'secret'***REMOVED***, function() ***REMOVED******REMOVED***);
        ***REMOVED***).to.throw(TypeError);
    ***REMOVED***);
***REMOVED***);
