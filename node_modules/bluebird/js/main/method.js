"use strict";
module.exports =
function(Promise, INTERNAL, tryConvertToPromise, apiRejection) ***REMOVED***
var util = require("./util.js");
var tryCatch = util.tryCatch;

Promise.method = function (fn) ***REMOVED***
    if (typeof fn !== "function") ***REMOVED***
        throw new Promise.TypeError("fn must be a function\u000a\u000a    See http://goo.gl/916lJJ\u000a");
    ***REMOVED***
    return function () ***REMOVED***
        var ret = new Promise(INTERNAL);
        ret._captureStackTrace();
        ret._pushContext();
        var value = tryCatch(fn).apply(this, arguments);
        ret._popContext();
        ret._resolveFromSyncValue(value);
        return ret;
    ***REMOVED***;
***REMOVED***;

Promise.attempt = Promise["try"] = function (fn, args, ctx) ***REMOVED***
    if (typeof fn !== "function") ***REMOVED***
        return apiRejection("fn must be a function\u000a\u000a    See http://goo.gl/916lJJ\u000a");
    ***REMOVED***
    var ret = new Promise(INTERNAL);
    ret._captureStackTrace();
    ret._pushContext();
    var value = util.isArray(args)
        ? tryCatch(fn).apply(ctx, args)
        : tryCatch(fn).call(ctx, args);
    ret._popContext();
    ret._resolveFromSyncValue(value);
    return ret;
***REMOVED***;

Promise.prototype._resolveFromSyncValue = function (value) ***REMOVED***
    if (value === util.errorObj) ***REMOVED***
        this._rejectCallback(value.e, false, true);
    ***REMOVED*** else ***REMOVED***
        this._resolveCallback(value, true);
    ***REMOVED***
***REMOVED***;
***REMOVED***;
