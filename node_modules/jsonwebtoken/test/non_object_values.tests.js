var jwt = require('../index');
var expect = require('chai').expect;
var JsonWebTokenError = require('../lib/JsonWebTokenError');

describe('non_object_values values', function() ***REMOVED***

  it('should work with string', function () ***REMOVED***
    var token = jwt.sign('hello', '123');
    var result = jwt.verify(token, '123');
    expect(result).to.equal('hello');
  ***REMOVED***);

  //v6 version will throw in this case:
  it('should throw with expiresIn', function () ***REMOVED***
    expect(function () ***REMOVED***
      jwt.sign('hello', '123', ***REMOVED*** expiresIn: '12h' ***REMOVED***);
    ***REMOVED***).to.throw(/invalid expiresIn option for string payload/);
  ***REMOVED***);

  it('should fail to validate audience when the payload is string', function () ***REMOVED***
    var token = jwt.sign('hello', '123');
    expect(function () ***REMOVED***
      jwt.verify(token, '123', ***REMOVED*** audience: 'foo' ***REMOVED***);
    ***REMOVED***).to.throw(JsonWebTokenError);
  ***REMOVED***);

  it('should work with number', function () ***REMOVED***
    var token = jwt.sign(123, '123');
    var result = jwt.verify(token, '123');
    expect(result).to.equal('123');
  ***REMOVED***);

***REMOVED***);
