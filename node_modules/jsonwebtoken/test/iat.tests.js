var jwt = require('../index');
var expect = require('chai').expect;

describe('iat', function () ***REMOVED***

  it('should work with a exp calculated based on numeric iat', function () ***REMOVED***
    var dateNow = Math.floor(Date.now() / 1000);
    var iat = dateNow - 30;
    var expiresIn = 50;
    var token = jwt.sign(***REMOVED***foo: 123, iat: iat***REMOVED***, '123', ***REMOVED***expiresIn: expiresIn***REMOVED***);
    var result = jwt.verify(token, '123');
    expect(result.exp).to.be.closeTo(iat + expiresIn, 0.2);
  ***REMOVED***);


  it('should throw if iat is not a number', function () ***REMOVED***
    expect(function () ***REMOVED***
      jwt.sign(***REMOVED***foo: 123, iat: 'hello'***REMOVED***, '123');
    ***REMOVED***).to.throw(/"iat" must be a number/);
  ***REMOVED***);

***REMOVED***);