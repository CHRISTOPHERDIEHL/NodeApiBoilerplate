var colors = require('./colors'),
    styles = require('./styles');

module['exports'] = function () ***REMOVED***

  //
  // Extends prototype of native string object to allow for "foo".red syntax
  //
  var addProperty = function (color, func) ***REMOVED***
    String.prototype.__defineGetter__(color, func);
  ***REMOVED***;

  var sequencer = function sequencer (map, str) ***REMOVED***
      return function () ***REMOVED***
        var exploded = this.split(""), i = 0;
        exploded = exploded.map(map);
        return exploded.join("");
      ***REMOVED***
  ***REMOVED***;

  var stylize = function stylize (str, style) ***REMOVED***
    return styles[style].open + str + styles[style].close;
  ***REMOVED***

  addProperty('strip', function () ***REMOVED***
    return colors.strip(this);
  ***REMOVED***);

  addProperty('stripColors', function () ***REMOVED***
    return colors.strip(this);
  ***REMOVED***);

  addProperty("trap", function()***REMOVED***
    return colors.trap(this);
  ***REMOVED***);

  addProperty("zalgo", function()***REMOVED***
    return colors.zalgo(this);
  ***REMOVED***);

  addProperty("zebra", function()***REMOVED***
    return colors.zebra(this);
  ***REMOVED***);

  addProperty("rainbow", function()***REMOVED***
    return colors.rainbow(this);
  ***REMOVED***);

  addProperty("random", function()***REMOVED***
    return colors.random(this);
  ***REMOVED***);

  addProperty("america", function()***REMOVED***
    return colors.america(this);
  ***REMOVED***);

  //
  // Iterate through all default styles and colors
  //
  var x = Object.keys(colors.styles);
  x.forEach(function (style) ***REMOVED***
    addProperty(style, function () ***REMOVED***
      return stylize(this, style);
    ***REMOVED***);
  ***REMOVED***);

  function applyTheme(theme) ***REMOVED***
    //
    // Remark: This is a list of methods that exist
    // on String that you should not overwrite.
    //
    var stringPrototypeBlacklist = [
      '__defineGetter__', '__defineSetter__', '__lookupGetter__', '__lookupSetter__', 'charAt', 'constructor',
      'hasOwnProperty', 'isPrototypeOf', 'propertyIsEnumerable', 'toLocaleString', 'toString', 'valueOf', 'charCodeAt',
      'indexOf', 'lastIndexof', 'length', 'localeCompare', 'match', 'replace', 'search', 'slice', 'split', 'substring',
      'toLocaleLowerCase', 'toLocaleUpperCase', 'toLowerCase', 'toUpperCase', 'trim', 'trimLeft', 'trimRight'
    ];

    Object.keys(theme).forEach(function (prop) ***REMOVED***
      if (stringPrototypeBlacklist.indexOf(prop) !== -1) ***REMOVED***
        console.log('warn: '.red + ('String.prototype' + prop).magenta + ' is probably something you don\'t want to override. Ignoring style name');
      ***REMOVED***
      else ***REMOVED***
        if (typeof(theme[prop]) === 'string') ***REMOVED***
          colors[prop] = colors[theme[prop]];
          addProperty(prop, function () ***REMOVED***
            return colors[theme[prop]](this);
          ***REMOVED***);
        ***REMOVED***
        else ***REMOVED***
          addProperty(prop, function () ***REMOVED***
            var ret = this;
            for (var t = 0; t < theme[prop].length; t++) ***REMOVED***
              ret = exports[theme[prop][t]](ret);
            ***REMOVED***
            return ret;
          ***REMOVED***);
        ***REMOVED***
      ***REMOVED***
    ***REMOVED***);
  ***REMOVED***

  colors.setTheme = function (theme) ***REMOVED***
    if (typeof theme === 'string') ***REMOVED***
      try ***REMOVED***
        colors.themes[theme] = require(theme);
        applyTheme(colors.themes[theme]);
        return colors.themes[theme];
      ***REMOVED*** catch (err) ***REMOVED***
        console.log(err);
        return err;
      ***REMOVED***
    ***REMOVED*** else ***REMOVED***
      applyTheme(theme);
    ***REMOVED***
  ***REMOVED***;

***REMOVED***;